syntax = 'proto3';

package booking_service;

import "google/api/annotations.proto";
import "google/protobuf/timestamp.proto";

option go_package = "github.com/dezzmol/booking-service/internal/generated;generated";

service BookingService {
  rpc CreateHotel(CreateHotelRequest) returns (CreateHotelResponse) {
    option (google.api.http) = {
      post: "/v1/hotels"
      body: "*"
    };
  }

  rpc CreateRoom(CreateRoomRequest) returns (CreateRoomResponse) {
    option (google.api.http) = {
      post: "/v1/room"
      body: "*"
    };
  }

  rpc UpdateRoom(UpdateRoomRequest) returns (UpdateRoomResponse) {
    option (google.api.http) = {
      put: "/v1/room"
      body: "*"
    };
  }

  rpc CreateBooking(CreateBookingRequest) returns (CreateBookingResponse) {
    option (google.api.http) = {
      put: "/v1/booking"
      body: "*"
    };
  }

  rpc CancelBooking(CancelBookingRequest) returns (CancelBookingResponse) {
    option (google.api.http) = {
      delete: "/v1/booking/{booking_id}"
    };
  }

  rpc ModifyBooking(ModifyBookingRequest) returns (ModifyBookingResponse) {
    option (google.api.http) = {
      put: "/v1/booking/{booking_id}"
      body: "*"
    };
  }

  rpc CreateGuest(CreateGuestRequest) returns (CreateGuestResponse) {
    option (google.api.http) = {
      post: "/v1/guests"
      body: "*"
    };
  }

  rpc SubmitReview(SubmitReviewRequest) returns (SubmitReviewResponse) {
    option (google.api.http) = {
      post: "/v1/review"
      body: "*"
    };
  }
}

message CreateHotelRequest {
  string name = 1;
}

message CreateHotelResponse {
  Hotel hotel = 1;
}

message CreateRoomRequest {
  message DTO {
    string number = 1;
    string type = 2;
    uint64 hotel_id = 3;
  }

  repeated DTO dto = 1;
}

message CreateRoomResponse {
  Room room = 1;
}

message UpdateRoomRequest {
  uint64 room_id = 1;
  string number = 2;
  string type = 3;
  uint64 hotel_id = 4;
}

message UpdateRoomResponse {
  Room room = 1;
}

message CreateBookingRequest {
  message guest {
    string name = 1;
  }

  uint64 room_id = 1;
  google.protobuf.Timestamp start_date = 2;
  google.protobuf.Timestamp end_date = 3;
  string comment = 4;
  repeated guest guests = 5;
}

message CreateBookingResponse {
  Booking booking = 1;
}

message CancelBookingRequest {
  uint64 booking_id = 1;
}

message CancelBookingResponse {
}

message ModifyBookingRequest {
  uint64 booking_id = 1;
  google.protobuf.Timestamp start_date = 2;
  google.protobuf.Timestamp end_date = 3;
}

message ModifyBookingResponse {
  Booking booking = 1;
}

message CreateGuestRequest {
  string name = 1;
}

message CreateGuestResponse {
  Guest guest = 1;
}

message SubmitReviewRequest {
  uint64 booking_id = 1;
  uint64 guest_id = 2;
  int32 rating = 3;
  string comment = 4;
}

message SubmitReviewResponse {
  Review review = 1;
}

message Room {
  uint64 id = 1;
  google.protobuf.Timestamp created_at = 2;
  google.protobuf.Timestamp updated_at = 3;
  string number = 4;
  RoomType type = 5;
  uint64 hotel_id = 6;
}

message Review {
  uint64 id = 1;
  google.protobuf.Timestamp created_at = 2;
  google.protobuf.Timestamp updated_at = 3;
  uint64 booking_id = 4;
  uint64 guest_id = 5;
  int32 rating = 6;
  string comment = 7;
}

message Hotel {
  uint64 id = 1;
  google.protobuf.Timestamp created_at = 2;
  google.protobuf.Timestamp updated_at = 3;
  string name = 4;
}

message Guest {
  uint64 id = 1;
  google.protobuf.Timestamp created_at = 2;
  google.protobuf.Timestamp updated_at = 3;
  string name = 4;
}

message Booking {
  uint64 id = 1;
  google.protobuf.Timestamp created_at = 2;
  google.protobuf.Timestamp updated_at = 3;
  uint64 room_id = 4;
  google.protobuf.Timestamp start_date = 5;
  google.protobuf.Timestamp end_date = 6;
  string comment = 7;
  BookingStatus status = 8;
  repeated Guest guests = 10;
}

enum BookingStatus {
  BOOKING_STATUS_UNKNOWN = 0;
  BOOKING_STATUS_SUCCESS = 1;
  BOOKING_STATUS_CANCELLED = 2;
  BOOKING_STATUS_CONFIRMED = 3;
}

enum RoomType {
  ROOM_TYPE_UNKNOWN = 0;
  ROOM_TYPE_LOW_BUDGET = 1;
  ROOM_TYPE_MID_BUDGET = 2;
  ROOM_TYPE_HIGH_BUDGET = 3;
  ROOM_TYPE_HIGH_PRESIDENT = 4;
}